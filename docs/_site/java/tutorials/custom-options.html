<!DOCTYPE html>
<html lang="en-US">

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,maximum-scale=2">
    <link rel="stylesheet" type="text/css" media="screen" href="/assets/css/style.css?v=ae05660d25032fe3e5172bbcf187ddf4ef8c1a16">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Getting Started Tutorial | beamcookbook</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Getting Started Tutorial" />
<meta property="og:locale" content="en_US" />
<link rel="canonical" href="http://localhost:4000/java/tutorials/custom-options.html" />
<meta property="og:url" content="http://localhost:4000/java/tutorials/custom-options.html" />
<meta property="og:site_name" content="beamcookbook" />
<script type="application/ld+json">
{"headline":"Getting Started Tutorial","@type":"WebPage","url":"http://localhost:4000/java/tutorials/custom-options.html","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/arunneoz/beamcookbook">View on GitHub</a>

          <h1 id="project_title">beamcookbook</h1>
          <h2 id="project_tagline"></h2>

          
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1 id="getting-started-tutorial">Getting Started Tutorial</h1>
<p>Often with DataFlow you will need to define custom inputs when you run the workflow. This example will define a custom option class that we will use to store the runtime variables we need while defining our pipeline.</p>

<p><strong>Lauch Cloud Shell Tutorial</strong></p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cloudshell launch-tutorial docs/java/tutorials/custom-options.md
</code></pre></div></div>

<h2 id="open-project">Open Project</h2>
<p>CD into tutorial folders</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd </span>tutorials/java/custom-options
</code></pre></div></div>

<h2 id="understand-the-code">Understand The Code</h2>

<p><strong>AppOptions Class</strong></p>

<p>Open <walkthrough-editor-open-file filePath="/beamcookbook/tutorials/java/custom-options/src/main/java/com/gcp/cookbook/AppOptions.java">AppOptions.java</walkthrough-editor-open-file></p>

<p>This class has one runtime value, with a default. When you invoke the pipeline you will use this argument</p>
<pre><code class="language-(--minimumValue=5)```">

- &lt;walkthrough-editor-select-line
filePath="/beamcookbook/tutorials/java/custom-options/src/main/java/com/gcp/cookbook/AppOptions.java"
startLine="9" startCharacterOffset="0" 
endLine="9" endCharacterOffset="80"&gt;line 9&lt;/walkthrough-editor-select-line&gt;
Description of the property

- &lt;walkthrough-editor-select-line
filePath="/beamcookbook/tutorials/java/custom-options/src/main/java/com/gcp/cookbook/AppOptions.java"
startLine="10" startCharacterOffset="0" 
endLine="10" endCharacterOffset="80"&gt;line 10&lt;/walkthrough-editor-select-line&gt;
Default value, if this is not set the property is required.

- &lt;walkthrough-editor-select-line
filePath="/beamcookbook/tutorials/java/custom-options/src/main/java/com/gcp/cookbook/AppOptions.java"
startLine="11" startCharacterOffset="0" 
endLine="12" endCharacterOffset="80"&gt;line 11-12&lt;/walkthrough-editor-select-line&gt;
Getter and Setter methods for the property. 



**Pipeline Class**
This class defines the Apache Beam pipeline DAG, it also contains the Java Main method. 

Open &lt;walkthrough-editor-open-file filePath="/beamcookbook/tutorials/java/custom-options/src/main/java/com/gcp/cookbook/StarterPipeline.java"&gt;StarterPipeline.java&lt;/walkthrough-editor-open-file&gt;

- &lt;walkthrough-editor-select-line
filePath="/beamcookbook/tutorials/java/custom-options/src/main/java/com/gcp/cookbook/StarterPipeline.java"
startLine="38" startCharacterOffset="0" 
endLine="39" endCharacterOffset="80"&gt;line 50:&lt;/walkthrough-editor-select-line&gt;
Initializes the Pipeline with our custom AppOptions class. Now we can use the getter methods as needed.

- &lt;walkthrough-editor-select-line
filePath="/beamcookbook/tutorials/java/custom-options/src/main/java/com/gcp/cookbook/StarterPipeline.java"
startLine="41" startCharacterOffset="0" 
endLine="41" endCharacterOffset="80"&gt;line 42:&lt;/walkthrough-editor-select-line&gt;
Populate the pipeline with a list of Integers, so we have some messages to send through the pipeline.

- &lt;walkthrough-editor-select-line
filePath="/beamcookbook/tutorials/java/custom-options/src/main/java/com/gcp/cookbook/StarterPipeline.java"
startLine="43" startCharacterOffset="0" 
endLine="43" endCharacterOffset="80"&gt;line 44:&lt;/walkthrough-editor-select-line&gt;
Filter out all numbers smaller then the filterPattern.

- &lt;walkthrough-editor-select-line
filePath="/beamcookbook/tutorials/java/custom-options/src/main/java/com/gcp/cookbook/StarterPipeline.java"
startLine="45" startCharacterOffset="0" 
endLine="50" endCharacterOffset="80"&gt;line 46:&lt;/walkthrough-editor-select-line&gt;
Log the integers that passed the filter.

## Run Pipeline

*Run Locally*
```bash
mvn compile exec:java \
    -Dexec.mainClass=com.gcp.cookbook.StarterPipeline \
    -Dexec.args="--runner=DirectRunner"
</code></pre>

<p><em>Run with DataFlow</em></p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nb">export </span><span class="nv">project</span><span class="o">=</span>&lt;project id&gt;
</code></pre></div></div>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mvn compile <span class="nb">exec</span>:java <span class="se">\</span>
    <span class="nt">-Dexec</span>.mainClass<span class="o">=</span>com.gcp.cookbook.StarterPipeline <span class="se">\</span>
    <span class="nt">-Dexec</span>.args<span class="o">=</span><span class="s2">"--runner=DataFlowRunner --project=</span><span class="nv">$project</span><span class="s2">"</span>
</code></pre></div></div>

<p><em>Deploy Template</em></p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nb">export </span><span class="nv">project</span><span class="o">=</span>&lt;project id&gt;
</code></pre></div></div>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mvn compile <span class="nb">exec</span>:java <span class="se">\</span>
    <span class="nt">-Dexec</span>.mainClass<span class="o">=</span>com.gcp.cookbook.StarterPipeline <span class="se">\</span>
    <span class="nt">-Dexec</span>.args<span class="o">=</span><span class="s2">"--runner=DataFlowRunner --stagingLocation=gs://&lt;gcs bucket&gt;/staging"</span>
</code></pre></div></div>


      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        
        <p class="copyright">beamcookbook maintained by <a href="https://github.com/arunneoz">arunneoz</a></p>
        
        <p>Published with <a href="https://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    
  </body>
</html>
